window;import{jsx as e,Fragment as r,jsxs as n}from"react/jsx-runtime";import*as t from"react";import{DynamicComponent as o,RpcContext as s,useAsync as a,InteractiveCode as l,mapRpcError as i}from"@leanprover/infoview";function p({pos:s,html:a}){if("text"in a)return e(r,{children:a.text});if("element"in a){const[r,n,o]=a.element,l={};for(const[e,r]of n)l[e]=r;const i=o.map((e=>p({pos:s,html:e})));return"hr"===r?e("hr",{}):0===i.length?t.createElement(r,l):t.createElement(r,l,i)}if("component"in a){const[n,t,l]=a.component,i=l.map((e=>p({pos:s,html:e}))),c={...t,pos:s};return 0===i.length?e(o,{pos:s,hash:n,props:c}):e(o,{pos:s,hash:n,props:c,children:e(r,{children:i})})}return n("span",{className:"red",children:["Unknown HTML: ",JSON.stringify(a)]})}function c({expr:o}){const p=t.useContext(s),c=a((()=>p.call("ProofWidgets.ppExprTagged",{expr:o})),[o]);return"resolved"===c.state?e(l,{fmt:c.value}):"rejected"===c.state?n(r,{children:["Error: $",i(c.error).message]}):e(r,{children:"Loading.."})}function m({pos:o,expr:l,name:c}){const m=t.useContext(s),d=a((()=>async function(e,r,n){return await e.call("ProofWidgets.getExprPresentation",{expr:r,name:n})}(m,l,c)),[m,l,c]);return"resolved"===d.state?e(p,{pos:o,html:d.value}):"loading"===d.state?e(r,{children:"Loading.."}):n(r,{children:["Error: ",i(d.error).message]})}function d({pos:o,expr:l}){const p=t.useContext(s),d=a((()=>async function(e,r){return(await e.call("ProofWidgets.applicableExprPresenters",{expr:r})).presenters}(p,l)),[p,l]),[u,h]=t.useState(void 0);return"rejected"===d.state?n(r,{children:["Error: ",i(d.error).message]}):"resolved"===d.state&&0<d.value.length?n("div",{style:{display:"flow-root"},children:[u&&"none"!==u?e(m,{pos:o,expr:l,name:u}):e(c,{expr:l}),n("select",{className:"fr",onChange:e=>h(e.target.value),children:[e("option",{value:"none",children:"Default"},"none"),d.value.map((r=>e("option",{value:r.name,children:r.userName},r.name)))]})]}):e(c,{expr:l})}export{d as default};
